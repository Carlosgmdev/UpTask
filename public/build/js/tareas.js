!function(){const e=document;!async function(){try{const e="/api/tareas?id="+s(),a=await fetch(e),n=await a.json();t=n.tareas,i()}catch(e){console.log(e)}}();let t=[],a=[];e.querySelector("#agregar-tarea").addEventListener("click",(function(){o()}));function n(e){const n=e.target.value;a=""!==n?t.filter(e=>e.estado===n):[],i()}function o(a=!1,n={}){const o=e.createElement("DIV");o.classList.add("modal"),o.innerHTML=`\n            <form class="formulario nueva-tarea">\n                <legend>${a?"Editar tarea":"Añade una nueva tarea"}</legend>\n                <div class="campo">\n                    <label for="tarea">Tarea</label>\n                    <input \n                        type="text" \n                        name="tarea" \n                        id="tarea" \n                        placeholder="${n.nombre?"Edita la tarea":"Añade una tarea"}"\n                        value="${n.nombre?n.nombre:""}">\n                </div>\n                <div class="opciones">\n                    <input type="submit" class="submit-nueva-tarea" value="${a?"Guardar cambios":"Añadir tarea"}">\n                    <button type="button" class="cerrar-modal">Cancelar</button>\n                </div>\n            </form>\n        `,setTimeout(()=>{e.querySelector(".formulario").classList.add("animar")},0),o.addEventListener("click",d=>{if(d.preventDefault(),d.target.classList.contains("cerrar-modal")){e.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{o.remove()},500)}if(d.target.classList.contains("submit-nueva-tarea")){const o=e.querySelector("#tarea").value.trim();if(""===o)return void r("DEBES DARLE UN NOMBRE A LA TAREA","error",".formulario legend");a?(n.nombre=o,c(n)):async function(a){const n=new FormData;n.append("nombre",a),n.append("proyectoId",s());try{const o="http://localhost:8080/api/tarea",s=await fetch(o,{method:"POST",body:n}),c=await s.json();if(r(c.mensaje,c.tipo,".formulario legend"),"exito"===c.tipo){const n=e.querySelector(".modal");setTimeout(()=>{n.remove()},2e3);const o={id:String(c.id),nombre:a,estado:0,proyectoId:c.proyectoId};t=[...t,o],i()}}catch(e){console.log(e)}}(o)}}),e.querySelector(".dashboard").appendChild(o)}function r(t,a,n){const o=e.querySelector(".alerta");o&&o.remove();const r=e.createElement("DIV");r.textContent=t,r.classList.add("alerta",a);const s=e.querySelector(n);s.parentElement.insertBefore(r,s.nextElementSibling),setTimeout(()=>{r.remove()},5e3)}function s(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}function i(){!function(){const t=e.querySelector("#listado-tareas");for(;t.firstChild;)t.removeChild(t.firstChild)}(),function(){const a=t.filter(e=>"0"===e.estado),n=e.querySelector("#pendientes");0===a.length?n.disabled=!0:n.disabled=!1}(),function(){const a=t.filter(e=>"1"===e.estado),n=e.querySelector("#completas");0===a.length?n.disabled=!0:n.disabled=!1}();const n=a.length?a:t;if(0===n.length){const t=e.querySelector("#listado-tareas"),a=e.createElement("LI");return a.textContent="Aun no tienes tareas, comienza agregando una 📝.",a.classList.add("no-tareas"),void t.appendChild(a)}const r={0:"Pendiente",1:"Completado"};n.forEach(a=>{const n=e.createElement("LI");n.dataset.tareaId=a.id,n.classList.add("tarea");const d=e.createElement("P");d.textContent=a.nombre,d.ondblclick=function(){o(!0,{...a})};const l=e.createElement("DIV");l.classList.add("opciones");const u=e.createElement("BUTTON");u.classList.add("estado-tarea"),u.classList.add(""+r[a.estado].toLowerCase()),u.textContent=r[a.estado],u.dataset.estadoTarea=a.estado,u.ondblclick=function(){!function(e){const t="1"===e.estado?"0":"1";e.estado=t,c(e)}({...a})};const m=e.createElement("BUTTON");m.classList.add("eliminar-tarea"),m.dataset.idTarea=a.id,m.textContent="Eliminar",m.ondblclick=function(){!function(e){Swal.fire({title:"¿Estas seguro de eliminar la tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(a=>{a.isConfirmed&&async function(e){const{estado:a,id:n,nombre:o}=e,r=new FormData;r.append("id",n),r.append("nombre",o),r.append("estado",a),r.append("proyectoId",s());try{const a="http://localhost:8080/api/tarea/eliminar",n=await fetch(a,{method:"POST",body:r}),o=await n.json();o.resultado&&(Swal.fire("¡Eliminado!",o.mensaje,"success"),t=t.filter(t=>t.id!==e.id),i())}catch(e){console.log(e)}}(e)})}({...a})},l.appendChild(u),l.appendChild(m),n.appendChild(d),n.appendChild(l);e.querySelector("#listado-tareas").appendChild(n)})}async function c(a){const{estado:n,id:o,nombre:r}=a,c=new FormData;c.append("id",o),c.append("nombre",r),c.append("estado",n),c.append("proyectoId",s());try{const a="http://localhost:8080/api/tarea/actualizar",s=await fetch(a,{method:"POST",body:c}),d=await s.json();if("exito"===d.respuesta.tipo){Swal.fire(d.respuesta.mensaje,d.respuesta.mensaje,"success");e.querySelector(".modal")&&(tareaMemoria.estado=n),t=t.map(e=>(e.id===o&&(e.estado=n,e.nombre=r),e)),i()}}catch(e){console.log(e)}}e.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",n)})}();
//# sourceMappingURL=tareas.js.map
